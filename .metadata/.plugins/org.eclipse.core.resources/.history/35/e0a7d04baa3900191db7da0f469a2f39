package tictactoe;

import java.util.Scanner;

import tictactoe.SpieleEvaluator.Spielstand;

public class SpieleEngine {
	private Spielbrett brett = new Spielbrett();
	private Scanner scanner = new Scanner(System.in);
	private SpieleEvaluator evaluator = new SpieleEvaluator();
	private Spielstand spielstand;
	private int spieler = 1;
	private GrafikEngine grafik = new GrafikEngine();

	public void naechstenSpielzugBeginnen() {
		grafik.ausgabe(brett.ausgabe());
		inputVerarbeiten();
	}

	private void inputVerarbeiten() {
		System.out.print("Kommando: ");
		String kommando = scanner.next();
		try {
			eingabeVerarbeiten(kommando);
		} catch(Exception e){
			System.out.println(e.getMessage());
			inputVerarbeiten();
		}
	}

	private void eingabeVerarbeiten(String kommando) throws Exception {
		//TODO: Spiel geht nach Zug weiter
		switch (kommando) {
			case "A0": spielzugDurchführen(0); break;
			case "B0": spielzugDurchführen(1); break;
			case "C0": spielzugDurchführen(2); break;
	        case "A1": spielzugDurchführen(3); break;
	        case "B1": spielzugDurchführen(4); break;
	        case "C1": spielzugDurchführen(5); break;
	        case "A2": spielzugDurchführen(6); break;
	        case "B2": spielzugDurchführen(7); break;
	        case "C2": spielzugDurchführen(8); break;
	        case "neu": brett = new Spielbrett(); this.naechstenSpielzugBeginnen(); break;
	        case "ende": break;
	        default:
	        	throw new Exception("Ungültiger Befehl.");
		}	
	}

	private void spielzugDurchführen(int spielfeld) throws Exception {
		brett.zug(spielfeld, spieler);
		spielerWechsel();
		spielstand = evaluator.spielstandEvaluieren(brett);
		inputVerarbeiten();
	}

	private void spielerWechsel() {
		if (spieler == 1) spieler ++;
		else spieler--;
	}
		
	public static void main(String [] args) {
		new SpieleEngine().naechstenSpielzugBeginnen();
	}
}
