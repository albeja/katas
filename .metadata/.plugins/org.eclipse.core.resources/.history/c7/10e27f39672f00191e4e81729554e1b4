package textUmbruch;

import java.util.ArrayList;
import java.util.List;

public class TextWrapper {
	public String umbrechen(String text, int maxZeilenlänge) {
		List<String> ausgabeZeilen = zeilenErstellen(text, maxZeilenlänge);
		
		return ausgabeTextErstellen(ausgabeZeilen);
	}

	private String ausgabeTextErstellen(List<String> ausgabeZeilen) {
		String ausgabeString = "";
		
		for(int lineIndex = 0; lineIndex < ausgabeZeilen.size(); lineIndex++) {
			ausgabeString = ausgabeString.concat(ausgabeZeilen.get(lineIndex));
			if (lineIndex < ausgabeZeilen.size() - 1) ausgabeString = ausgabeString.concat("\r\n");
		}
		return ausgabeString;
	}

	private List<String> zeilenErstellen(String text, int maxZeilenlänge) {
		List<String> ausgabeZeilen = new ArrayList<String>();
		String[] textGetrennt = inputAufbereiten(text);
		String naechsteZeile = "";
		
		for (int wordIndex = 0; wordIndex < textGetrennt.length; wordIndex++) {
			String naechstesWort = textGetrennt[wordIndex];
			
			naechsteZeile = wortPruefen(maxZeilenlänge, ausgabeZeilen, naechsteZeile, naechstesWort);
		}
		ausgabeZeilen.add(naechsteZeile.trim());
		
		return ausgabeZeilen;
	}

	private String wortPruefen(int maxZeilenlänge, List<String> ausgabeZeilen, String naechsteZeile,
			String naechstesWort) {
		if(passtWortInZeile(naechstesWort, naechsteZeile, maxZeilenlänge)) {
			naechsteZeile = naechsteZeile.concat(naechstesWort + " ");
		} else {
			if (naechsteZeile == "") {
				naechsteZeile = naechstesWort.substring(0, maxZeilenlänge +1);
				ausgabeZeilen.add(naechsteZeile.trim());
				naechsteZeile = naechstesWort.substring(maxZeilenlänge) + " ";
			} else {
				ausgabeZeilen.add(naechsteZeile.trim());
				naechsteZeile = naechstesWort + " ";
			}
			
			if (naechsteZeile.length() - 1 > maxZeilenlänge) {
				ausgabeZeilen.add(naechsteZeile.substring(0, maxZeilenlänge));
				naechsteZeile = naechsteZeile.trim().substring(maxZeilenlänge) + " ";
			}
		}
		return naechsteZeile;
	}

	private boolean passtWortInZeile(String naechstesWort, String naechsteZeile, int maxZeilenlänge) {
		return (naechsteZeile.length() + naechstesWort.length() + 1 <= maxZeilenlänge);
		
	}

	private String[] inputAufbereiten(String text) {
		return text.split(" ");
	}

	
}
